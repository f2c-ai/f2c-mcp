# 日志系统说明

## 📋 日志标识

系统使用不同的标识来区分消息来源和类型：

### 🏷️ 客户端标识

- `[MCP客户端]` - MCP 客户端发送/接收的消息
- `[业务处理器]` - 业务处理客户端发送/接收的消息  
- `[服务器]` - 消息中继服务器的日志

### 📨 消息类型

- `MCP业务请求` - MCP 客户端发起的业务请求
- `业务处理响应` - 业务处理器返回的响应
- `客户端注册` - 客户端注册消息

## 🔍 日志示例

### MCP 客户端发起请求
```
📡 [MCP客户端] 广播业务请求: get_html_content (req_123456)
📄 请求内容: {"componentName":"Button","framework":"react","style":"tailwind"}
```

### 服务器转发消息
```
📨 [服务器] 收到消息 [client_123]: business_request
📡 [服务器] 广播消息: MCP业务请求 [client_123]
📄 消息内容: {"componentName":"Button","framework":"react"...
```

### 业务处理器接收和处理
```
📡 [业务处理器] 收到MCP客户端请求: get_html_content [client_123]
📄 请求内容: {"componentName":"Button","framework":"react","style":"tailwind"}
✅ [业务处理器] 已广播处理结果: req_123456
📄 响应内容预览: {"content":"<div class=\"container\">...
```

### MCP 客户端接收响应
```
📡 [MCP客户端] 收到业务处理响应: req_123456
📄 响应内容预览: {"content":"<div class=\"container\">...
✅ [MCP客户端] 业务处理成功: req_123456
```

## 🎯 日志用途

### 1. 调试消息流
- 跟踪请求从发起到完成的完整路径
- 识别消息在哪个环节出现问题
- 验证消息内容是否正确传递

### 2. 性能监控
- 观察请求响应时间
- 监控并发请求处理情况
- 识别性能瓶颈

### 3. 系统状态
- 查看当前连接的客户端数量
- 监控客户端注册和断开情况
- 验证系统组件是否正常工作

## 🔧 日志级别

### 信息级别 (📡📨📋📊)
- 正常的消息流转
- 客户端连接状态
- 统计信息

### 成功级别 (✅)
- 操作成功完成
- 连接建立成功
- 处理结果正常

### 警告级别 (⚠️)
- 预期的错误情况
- 超时处理
- 连接失败（在测试环境中可接受）

### 错误级别 (❌💥)
- 意外的错误
- 消息解析失败
- 业务处理异常

## 📄 内容预览

为了避免日志过长，系统会自动截取消息内容的前100个字符并添加 `...` 后缀。完整内容仍然会在实际的消息传递中保持完整。